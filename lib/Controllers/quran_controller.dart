import 'package:get/get.dart';

class QuranController extends GetxController {
  final List<Map<String, dynamic>> surahs = List.generate(114, (index) {
    final number = index + 1;
    return {
      'number': number,
      'name': _surahNames[number] ?? 'Surah $number',
      'verses': _verseCounts[number] ?? 0,
      'type': _surahTypes[number] ?? 'Meccan',
      'revelationOrder': _revelationOrder[number] ?? 0,
    };
  });

  final List<Map<String, dynamic>> parahs = List.generate(30, (index) {
    final number = index + 1;
    return {
      'number': number,
      'name': 'Parah $number',
      'range': _parahRanges[number] ?? '',
      'startSurah': _parahStartSurah[number] ?? 1,
      'endSurah': _parahEndSurah[number] ?? 1,
    };
  });

  final RxSet<int> favouriteSurahs = <int>{}.obs;
  final RxSet<int> favouriteParahs = <int>{}.obs;

  void toggleSurahFavourite(int number) {
    if (!favouriteSurahs.remove(number)) {
      favouriteSurahs.add(number);
    }
  }

  void toggleParahFavourite(int number) {
    if (!favouriteParahs.remove(number)) {
      favouriteParahs.add(number);
    }
  }

  void removeSurahFavourite(int number) {
    favouriteSurahs.remove(number);
  }

  void removeParahFavourite(int number) {
    favouriteParahs.remove(number);
  }

  RxList<Map<String, dynamic>> get favouriteItems {
    final List<Map<String, dynamic>> items = [];

    // Access reactive sets to make this reactive
    final surahFavs = favouriteSurahs.toList();
    final parahFavs = favouriteParahs.toList();

    for (var surahNumber in surahFavs) {
      final surah = surahs.firstWhere(
        (s) => s['number'] == surahNumber,
        orElse: () => <String, dynamic>{},
      );
      if (surah.isNotEmpty) {
        items.add({...surah, 'isSurah': true});
      }
    }

    for (var parahNumber in parahFavs) {
      final parah = parahs.firstWhere(
        (p) => p['number'] == parahNumber,
        orElse: () => <String, dynamic>{},
      );
      if (parah.isNotEmpty) {
        items.add({...parah, 'isSurah': false});
      }
    }

    return items.obs;
  }

  // Complete Surah Names (All 114)
  static const Map<int, String> _surahNames = {
    1: 'Al-Fatiha',
    2: 'Al-Baqarah',
    3: 'Al-Imran',
    4: 'An-Nisa',
    5: 'Al-Maidah',
    6: 'Al-An\'am',
    7: 'Al-A\'raf',
    8: 'Al-Anfal',
    9: 'At-Tawbah',
    10: 'Yunus',
    11: 'Hud',
    12: 'Yusuf',
    13: 'Ar-Ra\'d',
    14: 'Ibrahim',
    15: 'Al-Hijr',
    16: 'An-Nahl',
    17: 'Al-Isra',
    18: 'Al-Kahf',
    19: 'Maryam',
    20: 'Ta-Ha',
    21: 'Al-Anbiya',
    22: 'Al-Hajj',
    23: 'Al-Mu\'minun',
    24: 'An-Nur',
    25: 'Al-Furqan',
    26: 'Ash-Shu\'ara',
    27: 'An-Naml',
    28: 'Al-Qasas',
    29: 'Al-Ankabut',
    30: 'Ar-Rum',
    31: 'Luqman',
    32: 'As-Sajdah',
    33: 'Al-Ahzab',
    34: 'Saba',
    35: 'Fatir',
    36: 'Ya-Sin',
    37: 'As-Saffat',
    38: 'Sad',
    39: 'Az-Zumar',
    40: 'Ghafir',
    41: 'Fussilat',
    42: 'Ash-Shura',
    43: 'Az-Zukhruf',
    44: 'Ad-Dukhan',
    45: 'Al-Jathiyah',
    46: 'Al-Ahqaf',
    47: 'Muhammad',
    48: 'Al-Fath',
    49: 'Al-Hujurat',
    50: 'Qaf',
    51: 'Adh-Dhariyat',
    52: 'At-Tur',
    53: 'An-Najm',
    54: 'Al-Qamar',
    55: 'Ar-Rahman',
    56: 'Al-Waqi\'ah',
    57: 'Al-Hadid',
    58: 'Al-Mujadila',
    59: 'Al-Hashr',
    60: 'Al-Mumtahanah',
    61: 'As-Saff',
    62: 'Al-Jumu\'ah',
    63: 'Al-Munafiqun',
    64: 'At-Taghabun',
    65: 'At-Talaq',
    66: 'At-Tahrim',
    67: 'Al-Mulk',
    68: 'Al-Qalam',
    69: 'Al-Haqqah',
    70: 'Al-Ma\'arij',
    71: 'Nuh',
    72: 'Al-Jinn',
    73: 'Al-Muzzammil',
    74: 'Al-Muddaththir',
    75: 'Al-Qiyamah',
    76: 'Al-Insan',
    77: 'Al-Mursalat',
    78: 'An-Naba',
    79: 'An-Nazi\'at',
    80: 'Abasa',
    81: 'At-Takwir',
    82: 'Al-Infitar',
    83: 'Al-Mutaffifin',
    84: 'Al-Inshiqaq',
    85: 'Al-Buruj',
    86: 'At-Tariq',
    87: 'Al-A\'la',
    88: 'Al-Ghashiyah',
    89: 'Al-Fajr',
    90: 'Al-Balad',
    91: 'Ash-Shams',
    92: 'Al-Layl',
    93: 'Ad-Duha',
    94: 'Ash-Sharh',
    95: 'At-Tin',
    96: 'Al-Alaq',
    97: 'Al-Qadr',
    98: 'Al-Bayyinah',
    99: 'Az-Zalzalah',
    100: 'Al-Adiyat',
    101: 'Al-Qari\'ah',
    102: 'At-Takathur',
    103: 'Al-Asr',
    104: 'Al-Humazah',
    105: 'Al-Fil',
    106: 'Quraysh',
    107: 'Al-Ma\'un',
    108: 'Al-Kawthar',
    109: 'Al-Kafirun',
    110: 'An-Nasr',
    111: 'Al-Masad',
    112: 'Al-Ikhlas',
    113: 'Al-Falaq',
    114: 'An-Nas',
  };

  // Complete Verse Counts (All 114)
  static const Map<int, int> _verseCounts = {
    1: 7,
    2: 286,
    3: 200,
    4: 176,
    5: 120,
    6: 165,
    7: 206,
    8: 75,
    9: 129,
    10: 109,
    11: 123,
    12: 111,
    13: 43,
    14: 52,
    15: 99,
    16: 128,
    17: 111,
    18: 110,
    19: 98,
    20: 135,
    21: 112,
    22: 78,
    23: 118,
    24: 64,
    25: 77,
    26: 227,
    27: 93,
    28: 88,
    29: 69,
    30: 60,
    31: 34,
    32: 30,
    33: 73,
    34: 54,
    35: 45,
    36: 83,
    37: 182,
    38: 88,
    39: 75,
    40: 85,
    41: 54,
    42: 53,
    43: 89,
    44: 59,
    45: 37,
    46: 35,
    47: 38,
    48: 29,
    49: 18,
    50: 45,
    51: 60,
    52: 49,
    53: 62,
    54: 55,
    55: 78,
    56: 96,
    57: 29,
    58: 22,
    59: 24,
    60: 13,
    61: 14,
    62: 11,
    63: 11,
    64: 18,
    65: 12,
    66: 12,
    67: 30,
    68: 52,
    69: 52,
    70: 44,
    71: 28,
    72: 28,
    73: 20,
    74: 56,
    75: 40,
    76: 31,
    77: 50,
    78: 40,
    79: 46,
    80: 42,
    81: 29,
    82: 19,
    83: 36,
    84: 25,
    85: 22,
    86: 17,
    87: 19,
    88: 26,
    89: 30,
    90: 20,
    91: 15,
    92: 21,
    93: 11,
    94: 8,
    95: 8,
    96: 19,
    97: 5,
    98: 8,
    99: 8,
    100: 11,
    101: 11,
    102: 8,
    103: 3,
    104: 9,
    105: 5,
    106: 4,
    107: 7,
    108: 3,
    109: 6,
    110: 3,
    111: 5,
    112: 4,
    113: 5,
    114: 6,
  };

  // Surah Types (Meccan/Medinan)
  static const Map<int, String> _surahTypes = {
    1: 'Meccan',
    2: 'Medinan',
    3: 'Medinan',
    4: 'Medinan',
    5: 'Medinan',
    6: 'Meccan',
    7: 'Meccan',
    8: 'Medinan',
    9: 'Medinan',
    10: 'Meccan',
    11: 'Meccan',
    12: 'Meccan',
    13: 'Medinan',
    14: 'Meccan',
    15: 'Meccan',
    16: 'Meccan',
    17: 'Meccan',
    18: 'Meccan',
    19: 'Meccan',
    20: 'Meccan',
    21: 'Meccan',
    22: 'Medinan',
    23: 'Meccan',
    24: 'Medinan',
    25: 'Meccan',
    26: 'Meccan',
    27: 'Meccan',
    28: 'Meccan',
    29: 'Meccan',
    30: 'Meccan',
    31: 'Meccan',
    32: 'Meccan',
    33: 'Medinan',
    34: 'Meccan',
    35: 'Meccan',
    36: 'Meccan',
    37: 'Meccan',
    38: 'Meccan',
    39: 'Meccan',
    40: 'Meccan',
    41: 'Meccan',
    42: 'Meccan',
    43: 'Meccan',
    44: 'Meccan',
    45: 'Meccan',
    46: 'Meccan',
    47: 'Medinan',
    48: 'Medinan',
    49: 'Medinan',
    50: 'Meccan',
    51: 'Meccan',
    52: 'Meccan',
    53: 'Meccan',
    54: 'Meccan',
    55: 'Medinan',
    56: 'Meccan',
    57: 'Medinan',
    58: 'Medinan',
    59: 'Medinan',
    60: 'Medinan',
    61: 'Medinan',
    62: 'Medinan',
    63: 'Medinan',
    64: 'Medinan',
    65: 'Medinan',
    66: 'Medinan',
    67: 'Meccan',
    68: 'Meccan',
    69: 'Meccan',
    70: 'Meccan',
    71: 'Meccan',
    72: 'Meccan',
    73: 'Meccan',
    74: 'Meccan',
    75: 'Meccan',
    76: 'Medinan',
    77: 'Meccan',
    78: 'Meccan',
    79: 'Meccan',
    80: 'Meccan',
    81: 'Meccan',
    82: 'Meccan',
    83: 'Meccan',
    84: 'Meccan',
    85: 'Meccan',
    86: 'Meccan',
    87: 'Meccan',
    88: 'Meccan',
    89: 'Meccan',
    90: 'Meccan',
    91: 'Meccan',
    92: 'Meccan',
    93: 'Meccan',
    94: 'Meccan',
    95: 'Meccan',
    96: 'Meccan',
    97: 'Meccan',
    98: 'Medinan',
    99: 'Medinan',
    100: 'Meccan',
    101: 'Meccan',
    102: 'Meccan',
    103: 'Meccan',
    104: 'Meccan',
    105: 'Meccan',
    106: 'Meccan',
    107: 'Meccan',
    108: 'Meccan',
    109: 'Meccan',
    110: 'Medinan',
    111: 'Meccan',
    112: 'Meccan',
    113: 'Meccan',
    114: 'Meccan',
  };

  // Revelation Order (approximate)
  static const Map<int, int> _revelationOrder = {
    1: 5,
    2: 87,
    3: 89,
    4: 92,
    5: 112,
    6: 55,
    7: 39,
    8: 88,
    9: 113,
    10: 51,
    11: 52,
    12: 53,
    13: 96,
    14: 72,
    15: 54,
    16: 70,
    17: 50,
    18: 69,
    19: 44,
    20: 45,
    21: 73,
    22: 103,
    23: 74,
    24: 102,
    25: 107,
    26: 26,
    27: 48,
    28: 49,
    29: 85,
    30: 84,
    31: 57,
    32: 75,
    33: 90,
    34: 58,
    35: 43,
    36: 41,
    37: 56,
    38: 38,
    39: 59,
    40: 60,
    41: 61,
    42: 62,
    43: 63,
    44: 64,
    45: 65,
    46: 66,
    47: 95,
    48: 111,
    49: 106,
    50: 34,
    51: 67,
    52: 23,
    53: 21,
    54: 37,
    55: 97,
    56: 46,
    57: 94,
    58: 105,
    59: 101,
    60: 91,
    61: 109,
    62: 110,
    63: 104,
    64: 108,
    65: 99,
    66: 107,
    67: 77,
    68: 2,
    69: 78,
    70: 79,
    71: 71,
    72: 40,
    73: 3,
    74: 4,
    75: 31,
    76: 98,
    77: 33,
    78: 80,
    79: 81,
    80: 24,
    81: 7,
    82: 82,
    83: 86,
    84: 83,
    85: 27,
    86: 36,
    87: 8,
    88: 68,
    89: 10,
    90: 35,
    91: 26,
    92: 19,
    93: 11,
    94: 12,
    95: 28,
    96: 1,
    97: 25,
    98: 100,
    99: 93,
    100: 14,
    101: 13,
    102: 15,
    103: 16,
    104: 17,
    105: 18,
    106: 29,
    107: 30,
    108: 108,
    109: 109,
    110: 114,
    111: 6,
    112: 22,
    113: 20,
    114: 21,
  };

  // Complete Parah Ranges (All 30)
  static const Map<int, String> _parahRanges = {
    1: 'Al-Fatiha 1 – Al-Baqarah 141',
    2: 'Al-Baqarah 142 – Al-Baqarah 252',
    3: 'Al-Baqarah 253 – Al-Imran 92',
    4: 'Al-Imran 93 – An-Nisa 23',
    5: 'An-Nisa 24 – An-Nisa 147',
    6: 'An-Nisa 148 – Al-Maidah 81',
    7: 'Al-Maidah 82 – Al-An\'am 110',
    8: 'Al-An\'am 111 – Al-An\'am 165',
    9: 'Al-A\'raf 1 – Al-A\'raf 87',
    10: 'Al-A\'raf 88 – Al-Anfal 40',
    11: 'Al-Anfal 41 – At-Tawbah 92',
    12: 'At-Tawbah 93 – Hud 5',
    13: 'Hud 6 – Yusuf 52',
    14: 'Yusuf 53 – Al-Hijr 1',
    15: 'Al-Hijr 2 – An-Nahl 128',
    16: 'Al-Isra 1 – Al-Kahf 74',
    17: 'Al-Kahf 75 – Ta-Ha 135',
    18: 'Al-Anbiya 1 – Al-Hajj 78',
    19: 'Al-Mu\'minun 1 – Al-Furqan 20',
    20: 'Al-Furqan 21 – An-Naml 55',
    21: 'An-Naml 56 – Al-Ankabut 45',
    22: 'Al-Ankabut 46 – Al-Ahzab 30',
    23: 'Al-Ahzab 31 – Ya-Sin 27',
    24: 'Ya-Sin 28 – Az-Zumar 31',
    25: 'Az-Zumar 32 – Fussilat 46',
    26: 'Fussilat 47 – Al-Jathiyah 37',
    27: 'Al-Ahqaf 1 – Adh-Dhariyat 30',
    28: 'Adh-Dhariyat 31 – Al-Hadid 29',
    29: 'Al-Mujadila 1 – At-Tahrim 12',
    30: 'Al-Mulk 1 – An-Nas 6',
  };

  static const Map<int, int> _parahStartSurah = {
    1: 1,
    2: 2,
    3: 2,
    4: 3,
    5: 4,
    6: 4,
    7: 5,
    8: 6,
    9: 7,
    10: 7,
    11: 8,
    12: 9,
    13: 11,
    14: 12,
    15: 15,
    16: 17,
    17: 18,
    18: 21,
    19: 23,
    20: 25,
    21: 27,
    22: 29,
    23: 33,
    24: 36,
    25: 39,
    26: 41,
    27: 46,
    28: 51,
    29: 58,
    30: 67,
  };

  static const Map<int, int> _parahEndSurah = {
    1: 2,
    2: 2,
    3: 3,
    4: 4,
    5: 4,
    6: 5,
    7: 6,
    8: 6,
    9: 7,
    10: 8,
    11: 9,
    12: 11,
    13: 12,
    14: 15,
    15: 16,
    16: 18,
    17: 20,
    18: 22,
    19: 25,
    20: 27,
    21: 29,
    22: 33,
    23: 36,
    24: 39,
    25: 41,
    26: 45,
    27: 51,
    28: 57,
    29: 66,
    30: 114,
  };
}
